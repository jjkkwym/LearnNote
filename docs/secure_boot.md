# secure boot
这些都是安全启动链（secure boot chain）中的组件，各组件的作用如下：

1. brom (bootrom)：也称为引导加载程序，是系统芯片中的固化代码，用来启动系统，是整个启动链的第一步。brom可以确保启动加载的代码未被篡改和恶意攻击。一般情况下，brom的代码是只读的，不能被修改。

2. sboot (secondary bootloader)：第二阶段启动加载程序，是在brom之后启动的。sboot主要用来验证固件中的代码是否受信任，包括验证签名、完整性和真实性。如果验证通过，则继续往下启动，否则出现错误提示。

3. monitor (仅aarch64)：对ARMv8架构的芯片而言，这是用来启动trustzone安全分区的程序。它负责验证secure_os的签名并启动secure_os。

4. secure_os：也称为安全操作系统，它运行在安全分区中，提供较高级别的安全保障。在secure_os之前运行的所有组件，包括brom、sboot和monitor都是运行在非安全分区中的。secure_os可以验证uboot的签名并启动uboot。

5. uboot：主引导加载程序，它用来启动操作系统内核。uboot可以验证内核的签名，防止恶意代码的注入。

6. kernel：操作系统内核，它是系统的核心，负责管理计算机硬件资源和为应用程序提供服务。内核也可以进行安全功能的实现，例如隔离重要模块和应用程序，并对其数据进行加密保护等。

总之，这些组件都是安全启动链中不可或缺的一部分，它们在整个启动过程中各自发挥着不同的作用，保障系统的安全运行。

## r328安全启动
Tina 安全方案基于私钥签名-公钥验签的业界公认非对称算法实现完整的安全启动方案，具体来说，选择的是 RSA2048-SHA256。
先使用私钥给固件进行签名生成安全固件，再将根密钥公钥的 SHA256 值即 rotpk.bin 烧写至芯片中 efuse 特定区域。启动时，固化在芯片的 brom 程序首先会读取 efuse 中的 rotpk 值，将该值与保存在 flash 上的根证书中公钥进行 SHA256 运算后的值进行比对，验证根证书中公钥的可信任性。然后会使用 flash 上存储的证书链中的一系列公钥来对各个子镜像进行逐级安全校验。验证顺序为 brom->sboot->monitor(仅 aarch64)-secure os->uboot->kernel。efuse 的不可更改性确保了证书链的可信任，整个流程的设计确保了整个 Linux 方案的安全启动。